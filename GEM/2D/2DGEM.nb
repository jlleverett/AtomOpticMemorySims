(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     48274,       1269]
NotebookOptionsPosition[     45437,       1195]
NotebookOutlinePosition[     45793,       1211]
CellTagsIndexPosition[     45750,       1208]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["2D Gradient Echo Memory Simulations", "Title",
 CellChangeTimes->{{3.735958825267984*^9, 3.73595883432259*^9}, {
  3.736557236680479*^9, 
  3.736557237527144*^9}},ExpressionUUID->"f181a0c8-f2bc-4321-8d81-\
e6c2065d440d"],

Cell["\<\
GEM in 2D. Nothing particularly interesting in this simulation (yet) but you \
can see the affect of waist size on backward recall. The transverse dimension \
is also important for the kspace memory and stationary light.\
\>", "Text",
 CellChangeTimes->{{3.735958841459547*^9, 3.735958951799644*^9}, {
  3.736624413640932*^9, 3.736624469629221*^9}, {3.7366247284991207`*^9, 
  3.736624730769617*^9}, {3.736626430001511*^9, 
  3.736626463494679*^9}},ExpressionUUID->"9871b6f5-0ce2-4f50-93fb-\
dc27df1f030e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h5Import", "[", 
    RowBox[{"filename_", ",", "samplinggroup_", ",", "momentname_"}], "]"}], ":=", 
   RowBox[{"Import", "[", 
    RowBox[{"filename", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", " ", 
       RowBox[{"\"\</\>\"", "<>", 
        RowBox[{"ToString", "[", "samplinggroup", "]"}], "<>", "\"\</\>\"", "<>",
         "momentname"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"runArgs", "[", 
    RowBox[{"filename_", ",", "args_"}], "]"}], ":=", 
   RowBox[{"Run", "[", 
    RowBox[{"\"\<./\>\"", "<>", "filename", "<>", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"StringTemplate", "[", "\"\< --``=``\>\"", "]"}], "@@", 
         "#"}], "&"}], "/@", "args"}], ")"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"importComplexArgs", "[", 
   RowBox[{"filename_", ",", "args_", ",", "moment_", ",", "group_"}], "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"h5Import", "[", 
    RowBox[{
     RowBox[{"filename", "<>", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringTemplate", "[", "\"\<.``_``\>\"", "]"}], "@@", "#"}],
          "&"}], "/@", "args"}], ")"}], "<>", "\"\<.h5\>\""}], ",", "group", 
     ",", 
     RowBox[{"moment", "<>", "\"\<R\>\""}]}], "]"}], "+", 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"h5Import", "[", 
     RowBox[{
      RowBox[{"filename", "<>", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"StringTemplate", "[", "\"\<.``_``\>\"", "]"}], "@@", 
           "#"}], "&"}], "/@", "args"}], ")"}], "<>", "\"\<.h5\>\""}], ",", 
      "group", ",", 
      RowBox[{"moment", "<>", "\"\<I\>\""}]}], "]"}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.7360147792537937`*^9, {3.736018097961034*^9, 3.736018127224052*^9}, {
   3.736018177711882*^9, 3.736018241653255*^9}, {3.7360191759435587`*^9, 
   3.736019197942102*^9}, {3.736019235197303*^9, 3.7360193214635353`*^9}, {
   3.736019375488205*^9, 3.736019390935495*^9}, {3.736019458870083*^9, 
   3.736019467493825*^9}, {3.736019528189363*^9, 3.736019684807905*^9}, {
   3.736019753800376*^9, 3.736019782421332*^9}, {3.736019842012294*^9, 
   3.736019848331788*^9}, {3.736019902653421*^9, 3.7360199971199093`*^9}, {
   3.736020082215261*^9, 3.736020204178388*^9}, {3.736020762556621*^9, 
   3.7360207633962793`*^9}, {3.7360209032402573`*^9, 3.736020917599889*^9}, {
   3.736020985438775*^9, 3.736020987676894*^9}, {3.736021107010749*^9, 
   3.7360211566881733`*^9}, {3.736022583857387*^9, 3.736022587162022*^9}, {
   3.736022666037146*^9, 3.736022689710063*^9}, 3.736025812041129*^9, {
   3.736555431847165*^9, 3.736555432641073*^9}, {3.736555506883915*^9, 
   3.736555512529839*^9}, {3.73662500635091*^9, 3.73662500922224*^9}, {
   3.736628538232135*^9, 3.736628539126309*^9}, {3.736632750953971*^9, 
   3.7366327513859158`*^9}, {3.736633103554184*^9, 3.7366331041856623`*^9}, {
   3.736633141472146*^9, 3.736633142080105*^9}, 
   3.736634643063723*^9},ExpressionUUID->"e0acd834-d8a1-4d7b-a227-\
59b0bfe97b4e"],

Cell["\<\
The initialisation cell contains functions to run and import compiled XMDS2 \
simulations.\
\>", "Text",
 CellChangeTimes->{{3.7360176424535627`*^9, 
  3.7360177031387453`*^9}},ExpressionUUID->"a51a25de-3dd2-4f7a-82b6-\
09c0cd9cb4be"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.736040507021021*^9, 
  3.7360405091281652`*^9}},ExpressionUUID->"31d827fd-1bcb-458f-8029-\
28d26f29a977"],

Cell[CellGroupData[{

Cell["3-Level GEM", "Section",
 CellChangeTimes->{{3.736044513211533*^9, 
  3.7360445160593147`*^9}},ExpressionUUID->"33f420c8-cadb-4e56-8eb1-\
75cd695b7bd7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"argsAssoc", "=", 
   RowBox[{"KeySort", "[", 
    RowBox[{"<|", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "The", " ", "output", " ", "file", " ", "name", " ", "is", " ", 
        "generated", " ", "using", " ", "all", " ", "the", " ", "arguments", 
        " ", "in", " ", "the", " ", "XMDS", " ", "script", " ", "in", " ", 
        "alphabetical", " ", 
        RowBox[{"order", ".", " ", "All"}], " ", "arguments", " ", "should", 
        " ", "be", " ", "included", " ", "here"}], ",", " ", 
       RowBox[{
       "and", " ", "the", " ", "notebook", " ", "sorts", " ", "them", " ", 
        "for", " ", 
        RowBox[{"you", "."}]}]}], "  ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<omega_in\>\"", "\[Rule]", "8"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<pulsewidth\>\"", "\[Rule]", " ", "1.2"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<bandwidth_in\>\"", "\[Rule]", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<tin\>\"", " ", "\[Rule]", " ", "2.8"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<delta_in\>\"", "\[Rule]", "200"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<od_in\>\"", "\[Rule]", "1000"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<waist\>\"", "\[Rule]", "0.00005"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<ang\>\"", " ", "\[Rule]", " ", "0"}]}], 
     "\[IndentingNewLine]", "|>"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"argsList", "=", 
   RowBox[{"KeyValueMap", "[", 
    RowBox[{"List", ",", "argsAssoc"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"script", "=", "\"\<2DGEM3L\>\""}], ";", 
   RowBox[{"output", "=", "\"\<2DGEM3L\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"runArgs", "[", 
    RowBox[{"script", ",", "argsList"}], "]"}], "*)"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "2", "D", " ", "simulations", " ", "can", " ", "take", " ", "a", " ", 
     "lot", " ", 
     RowBox[{"longer", ".", " ", "You"}], " ", "may", " ", "want", " ", "to", 
     " ", "run", " ", "on", " ", "a", " ", "more", " ", "powerful", " ", 
     "machine"}], " ", "-", " ", 
    RowBox[{
    "and", " ", "Mathematica", " ", "can", " ", "time", " ", "out"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"moments", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<S\>\"", ",", "\"\<E\>\"", ",", "\"\<P\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"AssociationMap", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"importComplexArgs", "[", 
       RowBox[{"output", ",", "argsList", ",", "#", ",", "1"}], "]"}], "&"}], 
     ",", "moments"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ss", "=", 
    RowBox[{"data", "[", "\"\<S\>\"", "]"}]}], ";", 
   RowBox[{"ee", "=", 
    RowBox[{"data", "[", "\"\<E\>\"", "]"}]}], ";", 
   RowBox[{"pp", "=", 
    RowBox[{"data", "[", "\"\<P\>\"", "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Using", " ", "an", " ", "association", " ", "for", " ", "import", " ", 
     "is", " ", "quick", " ", "and", " ", "modular"}], ",", " ", 
    RowBox[{
    "and", " ", "gives", " ", "you", " ", "freedom", " ", "to", " ", "then", 
     " ", "manipulate", " ", "variables", " ", "based", " ", "on", " ", "the",
      " ", "data"}]}], " ", "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7360445654603853`*^9, 3.736044592635584*^9}, {
   3.736044636780613*^9, 3.736044638155175*^9}, {3.736045395679018*^9, 
   3.736045408604958*^9}, 3.736047284697627*^9, {3.736047933069779*^9, 
   3.736048057207288*^9}, {3.736048111729677*^9, 3.7360482184590073`*^9}, 
   3.736123194109342*^9, {3.736130928361239*^9, 3.736131129682366*^9}, {
   3.736131187697359*^9, 3.736131262176949*^9}, {3.736131304444296*^9, 
   3.736131341276844*^9}, {3.736131400938837*^9, 3.736131414295972*^9}, 
   3.736554199559349*^9, {3.736554655195804*^9, 3.73655466045452*^9}, {
   3.736555027355762*^9, 3.736555072787466*^9}, {3.7365551200088882`*^9, 
   3.736555148591601*^9}, {3.736555212442668*^9, 3.736555215557061*^9}, 
   3.7365560133132687`*^9, 3.736559979668613*^9, 3.736560125829069*^9, 
   3.736560524611771*^9, {3.736561220230936*^9, 3.736561220356805*^9}, {
   3.736623883066127*^9, 3.736623931029169*^9}, {3.736624973841481*^9, 
   3.736624979089232*^9}, 3.736628535705757*^9, 3.736628652514351*^9, {
   3.736631023900798*^9, 3.73663103813877*^9}, {3.7366327595284758`*^9, 
   3.73663283216521*^9}, {3.736632914803287*^9, 3.736632917009778*^9}, {
   3.736632974111504*^9, 3.7366329777909813`*^9}, {3.7366330462473927`*^9, 
   3.736633093842411*^9}, {3.7366333761911488`*^9, 3.736633474945376*^9}, {
   3.7366335070036507`*^9, 3.7366335074889593`*^9}, 3.7366346313776484`*^9, {
   3.736642043489155*^9, 
   3.73664204372066*^9}},ExpressionUUID->"79572421-6cc1-47fc-a4c4-\
dbf87c680188"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.736633038820623*^9, 
  3.736633044437422*^9}},ExpressionUUID->"f5bd42dc-7337-4d94-835e-\
49a7bfda0675"],

Cell[CellGroupData[{

Cell["Center row", "Subsection",
 CellChangeTimes->{{3.736556180647573*^9, 
  3.7365561905399923`*^9}},ExpressionUUID->"ef4b6e22-a689-49f3-8af3-\
745ee9195e3f"],

Cell[BoxData[{
 RowBox[{"GraphicsRow", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"ss", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "All", ",", "10"}], "]"}], "]"}], "2"], 
         "\[Transpose]"}], "]"}], ",", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0", ",", 
              RowBox[{"-", "0.5"}]}], "}"}], ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "2", ",", "4", ",", "6", ",", "8", ",", "10"}],
              "}"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<\[CapitalGamma]t\>\"", ",", 
            "\"\<|S\!\(\*SuperscriptBox[\(|\), \(2\)]\)\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<z\>\"", ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"1", "/", "GoldenRatio"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"ee", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "All", ",", "10"}], "]"}], "]"}], "2"], 
         "\[Transpose]"}], "]"}], ",", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0", ",", 
              RowBox[{"-", "0.5"}]}], "}"}], ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "2", ",", "4", ",", "6", ",", "8", ",", "10"}],
              "}"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<\[CapitalGamma]t\>\"", ",", 
            "\"\<|E\!\(\*SuperscriptBox[\(|\), \(2\)]\)\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<z\>\"", ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"1", "/", "GoldenRatio"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Abs", "[", 
          SuperscriptBox[
           RowBox[{"ee", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1", ",", "10"}], "]"}], "]"}], "2"], "]"}], 
         ",", 
         RowBox[{"Abs", "[", 
          SuperscriptBox[
           RowBox[{"ee", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"-", "1"}], ",", "10"}], "]"}], "]"}], "2"], "]"}]}], 
        "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "10"}], "}"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0.5", ",", "1"}], "}"}], ",", "None"}], "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "2", ",", "4", ",", "6", ",", "8", ",", "10"}],
              "}"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<|E\!\(\*SuperscriptBox[\(|\), \(2\)]\)\>\"", ",", "None"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<\[CapitalGamma]t\>\"", ",", 
            RowBox[{"TemplateApply", "[", 
             RowBox[{
             "\"\<d=`od`,  \[CapitalOmega]=`omega_in`\[CapitalGamma],  \
BW=`bandwidth_in`\[CapitalGamma],  \[CapitalDelta]=`delta_in`\[CapitalGamma], \
 \[Eta]=`efficiency`\>\"", ",", "argsAssoc"}], "]"}]}], "}"}]}], "}"}]}]}], 
      "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ArrayPlot", "[", 
  RowBox[{
   RowBox[{"Reverse", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"pp", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "All", ",", "10"}], "]"}], "]"}], "2"], 
     "\[Transpose]"}], "]"}], ",", 
   RowBox[{"DataRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameTicks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0", ",", 
          RowBox[{"-", "0.5"}]}], "}"}], ",", "None"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "2", ",", "4", ",", "6", ",", "8", ",", "10"}], 
         "}"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<\[CapitalGamma]t\>\"", ",", 
        "\"\<|P\!\(\*SuperscriptBox[\(|\), \(2\)]\)\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<z\>\"", ",", "None"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", 
    RowBox[{"1", "/", "GoldenRatio"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7360445654603853`*^9, 3.736044592635584*^9}, {
   3.736044636780613*^9, 3.736044638155175*^9}, {3.736045395679018*^9, 
   3.736045408604958*^9}, 3.736047284697627*^9, {3.736047933069779*^9, 
   3.736048057207288*^9}, {3.736048111729677*^9, 3.7360482184590073`*^9}, 
   3.736123194109342*^9, {3.736130928361239*^9, 3.736131129682366*^9}, {
   3.736131187697359*^9, 3.736131262176949*^9}, {3.736131304444296*^9, 
   3.736131341276844*^9}, {3.736131400938837*^9, 3.736131414295972*^9}, 
   3.736554199559349*^9, {3.736554655195804*^9, 3.73655466045452*^9}, {
   3.736555027355762*^9, 3.736555072787466*^9}, {3.7365551200088882`*^9, 
   3.736555148591601*^9}, {3.736555212442668*^9, 3.736555215557061*^9}, {
   3.736556208383062*^9, 3.736556224782349*^9}, {3.736556284259242*^9, 
   3.736556323328762*^9}, 3.736556465796633*^9, {3.736556722380981*^9, 
   3.7365567325618277`*^9}, {3.736557778171482*^9, 3.736557778344183*^9}, {
   3.7365578199311647`*^9, 3.7365578272489033`*^9}, {3.736560144950107*^9, 
   3.736560148067067*^9}, {3.736624013733839*^9, 
   3.7366240142915277`*^9}},ExpressionUUID->"7d670f2f-7076-41df-9c71-\
f98a61ea2c06"],

Cell[BoxData[
 RowBox[{"KeySort", "[", "argsAssoc", "]"}]], "Input",
 CellChangeTimes->{{3.7366248869459953`*^9, 3.736624895419816*^9}, {
  3.736624966441689*^9, 
  3.7366249670884542`*^9}},ExpressionUUID->"6eb26d12-3d41-401b-a3f3-\
bee0e3c41a19"],

Cell[BoxData["argsList"], "Input",
 CellChangeTimes->{{3.736624990557095*^9, 
  3.736624992683115*^9}},ExpressionUUID->"1ae13ed2-1047-4963-bfdd-\
e705f13d1f2d"],

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"StringTemplate", "[", "\"\< --``=``\>\"", "]"}], "@@", "#"}], 
    "&"}], "/@", 
   RowBox[{"Normal", "[", "argsAssoc", "]"}]}], ")"}]], "Input",
 CellChangeTimes->{{3.736625435908791*^9, 
  3.736625459474121*^9}},ExpressionUUID->"684897d5-1cb0-49d0-9a0c-\
050f5985bff5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sum over all transverse dimension", "Subsection",
 CellChangeTimes->{{3.736625950950169*^9, 3.736625954676688*^9}, {
  3.736656772582779*^9, 
  3.736656777611401*^9}},ExpressionUUID->"70c182e5-82a8-4685-bcd3-\
941839c47cd1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"isss", "=", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"Abs", "[", 
      SuperscriptBox["ss", "2"], "]"}], ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";", 
  RowBox[{"iees", "=", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"Abs", "[", 
      SuperscriptBox["ee", "2"], "]"}], ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";", 
  RowBox[{"ipps", "=", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"Abs", "[", 
      SuperscriptBox["pp", "2"], "]"}], ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssociateTo", "[", 
   RowBox[{"argsAssoc", ",", 
    RowBox[{"\"\<efficiency\>\"", "\[Rule]", 
     RowBox[{"NumberForm", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{"iees", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"102", ";;", 
              RowBox[{"-", "1"}]}], ",", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "]"}], "/", 
        RowBox[{"Total", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{"iees", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
       "3"}], "]"}]}]}], "]"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Calculate", " ", "efficiency", " ", "from", " ", "the", " ", "intensity",
      " ", "in", " ", "and", " ", "the", " ", "recall", " ", "intensity"}], 
    ",", " ", 
    RowBox[{
    "and", " ", "append", " ", "it", " ", "to", " ", "the", " ", "arguments", 
     " ", "association", " ", "where", " ", "it", " ", "is", " ", 
     "convenient", " ", "to", " ", "grab", " ", "for", " ", "plot", " ", 
     RowBox[{"labels", "."}]}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7366259752212563`*^9, 3.736626095665242*^9}, {
   3.73662621845121*^9, 3.736626232122262*^9}, {3.736626299600979*^9, 
   3.736626300960577*^9}, {3.736628570948316*^9, 3.736628588813102*^9}, 
   3.7366286271546383`*^9, {3.736628679081212*^9, 3.736628682743729*^9}, {
   3.7366328660844812`*^9, 3.736632885522633*^9}, {3.736634497656122*^9, 
   3.736634565626342*^9}, {3.7366563613911543`*^9, 
   3.736656379709299*^9}},ExpressionUUID->"dc296ff9-869e-4444-a73e-\
3517af6d9fe9"],

Cell[BoxData[{
 RowBox[{"GraphicsRow", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"isss", "\[Transpose]"}], "]"}], ",", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0", ",", 
              RowBox[{"-", "0.5"}]}], "}"}], ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "2", ",", "4", ",", "6", ",", "8", ",", "10"}],
              "}"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<\[CapitalGamma]t\>\"", ",", 
            "\"\<\[Integral]|S\!\(\*SuperscriptBox[\(|\), \(2\)]\)dy\>\""}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<z\>\"", ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"1", "/", "GoldenRatio"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"iees", "\[Transpose]"}], "]"}], ",", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0", ",", 
              RowBox[{"-", "0.5"}]}], "}"}], ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "2", ",", "4", ",", "6", ",", "8", ",", "10"}],
              "}"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<\[CapitalGamma]t\>\"", ",", 
            "\"\<\[Integral]|E\!\(\*SuperscriptBox[\(|\), \(2\)]\)dy\>\""}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<z\>\"", ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"1", "/", "GoldenRatio"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"iees", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"iees", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "10"}], "}"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0.5", ",", "1"}], "}"}], ",", "None"}], "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "2", ",", "4", ",", "6", ",", "8", ",", "10"}],
              "}"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<\[Integral]|E\!\(\*SuperscriptBox[\(|\), \(2\)]\)dy\>\"", ",",
             "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<\[CapitalGamma]t\>\"", ",", 
            RowBox[{"TemplateApply", "[", 
             RowBox[{
             "\"\<d=`od_in`,  \[CapitalOmega]=`omega_in`\[CapitalGamma],  \
BW=`bandwidth_in`\[CapitalGamma],  \[CapitalDelta]=`delta_in`\[CapitalGamma], \
 \[Eta]=`efficiency`\>\"", ",", "argsAssoc"}], "]"}]}], "}"}]}], "}"}]}]}], 
      "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ArrayPlot", "[", 
  RowBox[{
   RowBox[{"Reverse", "[", 
    RowBox[{"ipps", "\[Transpose]"}], "]"}], ",", 
   RowBox[{"DataRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameTicks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0", ",", 
          RowBox[{"-", "0.5"}]}], "}"}], ",", "None"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "2", ",", "4", ",", "6", ",", "8", ",", "10"}], 
         "}"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<\[CapitalGamma]t\>\"", ",", 
        "\"\<\[Integral]|P\!\(\*SuperscriptBox[\(|\), \(2\)]\)dy\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<z\>\"", ",", "None"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", 
    RowBox[{"1", "/", "GoldenRatio"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7366261264495287`*^9, 3.736626158412785*^9}, {
  3.736626188976829*^9, 3.7366262426428223`*^9}, {3.73662632404825*^9, 
  3.736626378981238*^9}, {3.7366342734896193`*^9, 
  3.736634273984914*^9}},ExpressionUUID->"fd7211c9-860b-4755-ad10-\
ec10a9448b2a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Backward recall", "Section",
 CellChangeTimes->{{3.736626489926875*^9, 
  3.736626493565344*^9}},ExpressionUUID->"e100835a-469e-40d2-acb8-\
6fa82b533be6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"argsAssoc", "=", 
   RowBox[{"KeySort", "[", 
    RowBox[{"<|", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "The", " ", "output", " ", "file", " ", "name", " ", "is", " ", 
        "generated", " ", "using", " ", "all", " ", "the", " ", "arguments", 
        " ", "in", " ", "the", " ", "XMDS", " ", "script", " ", "in", " ", 
        "alphabetical", " ", 
        RowBox[{"order", ".", " ", "All"}], " ", "arguments", " ", "should", 
        " ", "be", " ", "included", " ", "here"}], ",", " ", 
       RowBox[{
       "the", " ", "notebook", " ", "sorts", " ", "them", " ", "for", " ", 
        RowBox[{"you", "."}]}]}], "  ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<omega_in\>\"", "\[Rule]", "8"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<pulsewidth\>\"", "\[Rule]", " ", "1.2"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<bandwidth_in\>\"", "\[Rule]", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<tin\>\"", " ", "\[Rule]", " ", "2.8"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<delta_in\>\"", "\[Rule]", "200"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<od_in\>\"", "\[Rule]", "1000"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<waist\>\"", "\[Rule]", "0.0001"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<angf\>\"", " ", "\[Rule]", " ", "0.006006"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<angb\>\"", " ", "\[Rule]", " ", "0.006006"}]}], 
     "\[IndentingNewLine]", "|>"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"argsList", "=", 
   RowBox[{"KeyValueMap", "[", 
    RowBox[{"List", ",", "argsAssoc"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"script", "=", "\"\<2DGEM3LBR\>\""}], ";", 
   RowBox[{"output", "=", "\"\<2DGEM3LBR\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"runArgs", "[", 
    RowBox[{"script", ",", "argsList"}], "]"}], "*)"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"moments", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<S\>\"", ",", "\"\<Ef\>\"", ",", "\"\<Eb\>\"", ",", "\"\<Pf\>\"", 
     ",", "\"\<Pb\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"AssociationMap", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"importComplexArgs", "[", 
       RowBox[{"output", ",", "argsList", ",", "#", ",", "1"}], "]"}], "&"}], 
     ",", "moments"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{"data", "[", "\"\<S\>\"", "]"}]}], ";", 
  RowBox[{"eef", "=", 
   RowBox[{"data", "[", "\"\<Ef\>\"", "]"}]}], ";", 
  RowBox[{"eeb", "=", 
   RowBox[{"data", "[", "\"\<Eb\>\"", "]"}]}], ";", 
  RowBox[{"ppf", "=", 
   RowBox[{"data", "[", "\"\<Pf\>\"", "]"}]}], ";", 
  RowBox[{"ppb", "=", 
   RowBox[{"data", "[", "\"\<Pb\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.736629900420874*^9, 3.736630090226808*^9}, {
   3.7366332038385277`*^9, 3.736633326360004*^9}, {3.7366334969614973`*^9, 
   3.7366335024011*^9}, {3.73663432775891*^9, 3.736634327825081*^9}, {
   3.736634362988105*^9, 3.7366343635161667`*^9}, 3.7366346389119864`*^9, 
   3.7366426651495523`*^9, 3.736642758017708*^9, {3.736643433948043*^9, 
   3.7366434343057413`*^9}, {3.736644350972107*^9, 3.7366443559384947`*^9}, {
   3.736644509908719*^9, 3.736644511650634*^9}, {3.736645174518593*^9, 
   3.736645174670331*^9}, {3.736653326211536*^9, 
   3.736653326491045*^9}},ExpressionUUID->"3f30506d-4a78-433d-8f05-\
07d67077c537"],

Cell[CellGroupData[{

Cell["Sum over all rows", "Subsection",
 CellChangeTimes->{{3.7366335683340893`*^9, 
  3.736633571276647*^9}},ExpressionUUID->"de0c7939-fe1b-41a7-b3c5-\
61da829a1e10"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"isss", "=", 
   RowBox[{"Total", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Abs", "[", "ss", "]"}], "2"], ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";", 
  RowBox[{"ieefs", "=", 
   RowBox[{"Total", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Abs", "[", "eef", "]"}], "2"], ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";", 
  RowBox[{"ieebs", "=", 
   RowBox[{"Total", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Abs", "[", "eeb", "]"}], "2"], ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";", 
  RowBox[{"ippfs", "=", 
   RowBox[{"Total", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Abs", "[", "ppf", "]"}], "2"], ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";", 
  RowBox[{"ippbs", "=", 
   RowBox[{"Total", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Abs", "[", "ppb", "]"}], "2"], ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssociateTo", "[", 
   RowBox[{"argsAssoc", ",", 
    RowBox[{"\"\<efficiency\>\"", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"Abs", "[", 
        RowBox[{"ieebs", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"102", ";;", 
            RowBox[{"-", "1"}]}], ",", "1"}], "]"}], "]"}], "]"}], "]"}], "/", 
      RowBox[{"Total", "[", 
       RowBox[{"Abs", "[", 
        RowBox[{"ieefs", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssociateTo", "[", 
   RowBox[{"argsAssoc", ",", 
    RowBox[{"\"\<efficiencystr\>\"", "\[Rule]", 
     RowBox[{"NumberForm", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{"ieebs", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"102", ";;", 
              RowBox[{"-", "1"}]}], ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
        "/", 
        RowBox[{"Total", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{"ieefs", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
       "3"}], "]"}]}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7366335770299673`*^9, 3.736633622887129*^9}, {
   3.7366339604293222`*^9, 3.736633963684258*^9}, {3.736643274834234*^9, 
   3.736643285856319*^9}, 3.736643345926201*^9, 
   3.736656346266837*^9},ExpressionUUID->"625aae0a-c1a9-4367-b8a4-\
48ff31767eb1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GraphicsGrid", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ArrayPlot", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"ieefs", "\[Transpose]"}], "]"}], ",", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "10"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0", ",", 
                 RowBox[{"-", "0.5"}]}], "}"}], ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "2", ",", "4", ",", "6", ",", "8", ",", "10"}], 
                "}"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<\[CapitalGamma]t\>\"", ",", 
               "\"\<\[Integral]|\!\(\*SubscriptBox[\(E\), \
\(+\)]\)\!\(\*SuperscriptBox[\(|\), \(2\)]\)dy\>\""}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<z\>\"", ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", 
           RowBox[{"1", "/", "GoldenRatio"}]}]}], "]"}], ",", 
        RowBox[{"ArrayPlot", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"ieebs", "\[Transpose]"}], "]"}], ",", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "10"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0", ",", 
                 RowBox[{"-", "0.5"}]}], "}"}], ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "2", ",", "4", ",", "6", ",", "8", ",", "10"}], 
                "}"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<\[CapitalGamma]t\>\"", ",", 
               "\"\<\[Integral]|\!\(\*SubscriptBox[\(E\), \
\(-\)]\)\!\(\*SuperscriptBox[\(|\), \(2\)]\)dy\>\""}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<z\>\"", ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", 
           RowBox[{"1", "/", "GoldenRatio"}]}]}], "]"}], ",", 
        RowBox[{"ArrayPlot", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"isss", "\[Transpose]"}], "]"}], ",", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "10"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0", ",", 
                 RowBox[{"-", "0.5"}]}], "}"}], ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "2", ",", "4", ",", "6", ",", "8", ",", "10"}], 
                "}"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<\[CapitalGamma]t\>\"", ",", 
               "\"\<\[Integral]|S\!\(\*SuperscriptBox[\(|\), \
\(2\)]\)dy\>\""}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<z\>\"", ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", 
           RowBox[{"1", "/", "GoldenRatio"}]}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ArrayPlot", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"ippfs", "\[Transpose]"}], "]"}], ",", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "10"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0", ",", 
                 RowBox[{"-", "0.5"}]}], "}"}], ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "2", ",", "4", ",", "6", ",", "8", ",", "10"}], 
                "}"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<\[CapitalGamma]t\>\"", ",", 
               "\"\<\[Integral]|\!\(\*SubscriptBox[\(P\), \
\(+\)]\)\!\(\*SuperscriptBox[\(|\), \(2\)]\)dy\>\""}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<z\>\"", ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", 
           RowBox[{"1", "/", "GoldenRatio"}]}]}], "]"}], ",", 
        RowBox[{"ArrayPlot", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"ippbs", "\[Transpose]"}], "]"}], ",", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "10"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0", ",", 
                 RowBox[{"-", "0.5"}]}], "}"}], ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "2", ",", "4", ",", "6", ",", "8", ",", "10"}], 
                "}"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<\[CapitalGamma]t\>\"", ",", 
               "\"\<\[Integral]|\!\(\*SubscriptBox[\(P\), \
\(-\)]\)\!\(\*SuperscriptBox[\(|\), \(2\)]\)dy\>\""}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<z\>\"", ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", 
           RowBox[{"1", "/", "GoldenRatio"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ieefs", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"ieefs", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
            RowBox[{"ieebs", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
            RowBox[{"ieebs", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "10"}], "}"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"None", ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "2", ",", "4", ",", "6", ",", "8", ",", "10"}], 
                "}"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<\[Integral]|E\!\(\*SuperscriptBox[\(|\), \(2\)]\)dy\>\"", 
               ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<\[CapitalGamma]t\>\"", ",", 
               RowBox[{"TemplateApply", "[", 
                RowBox[{
                "\"\<d=`od_in`,  \[CapitalOmega]=`omega_in`\[CapitalGamma],  \
BW=`bandwidth_in`\[CapitalGamma],  \[CapitalDelta]=`delta_in`\[CapitalGamma], \
 \[Eta]=`efficiencystr`\>\"", ",", "argsAssoc"}], "]"}]}], "}"}]}], "}"}]}]}],
          "]"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7366339810873833`*^9, 3.736634114074052*^9}, {
  3.736634146040164*^9, 3.736634195558219*^9}, {3.736634266747987*^9, 
  3.736634267325033*^9}, {3.736634423508626*^9, 3.736634428882674*^9}, {
  3.7366409125455017`*^9, 3.736640918372863*^9}, {3.7366429206458397`*^9, 
  3.7366429211208963`*^9}, {3.73664328994093*^9, 
  3.736643290341578*^9}},ExpressionUUID->"a017f664-8f29-4e36-b50f-\
0ef50c7dac9e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transverse analysis", "Subsection",
 CellChangeTimes->{{3.736643195852788*^9, 
  3.736643198899117*^9}},ExpressionUUID->"f554501f-4f4b-4ed2-bd60-\
4ca43aba4c49"],

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ArrayPlot", "[", 
     RowBox[{
      SuperscriptBox["ss", "2"], "[", 
      RowBox[{"[", "101", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ArrayPlot", "[", 
     RowBox[{
      SuperscriptBox["eef", "2"], "[", 
      RowBox[{"[", "57", "]"}], "]"}], "]"}], ",", 
    RowBox[{"ArrayPlot", "[", 
     RowBox[{
      SuperscriptBox["eeb", "2"], "[", 
      RowBox[{"[", "144", "]"}], "]"}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7366444471525097`*^9, 3.7366444909159184`*^9}, {
  3.73664609273624*^9, 
  3.736646148268756*^9}},ExpressionUUID->"fc73fa1b-5a80-45bd-bc43-\
f8822a86254b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1774, 922},
WindowMargins->{{45, Automatic}, {31, Automatic}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 226, 4, 92, "Title", "ExpressionUUID" -> \
"f181a0c8-f2bc-4321-8d81-e6c2065d440d"],
Cell[809, 28, 516, 9, 30, "Text", "ExpressionUUID" -> \
"9871b6f5-0ce2-4f50-93fb-dc27df1f030e"],
Cell[1328, 39, 3370, 78, 175, "Input", "ExpressionUUID" -> \
"e0acd834-d8a1-4d7b-a227-59b0bfe97b4e",
 InitializationCell->True],
Cell[4701, 119, 244, 6, 30, "Text", "ExpressionUUID" -> \
"a51a25de-3dd2-4f7a-82b6-09c0cd9cb4be"],
Cell[4948, 127, 154, 3, 32, "Input", "ExpressionUUID" -> \
"31d827fd-1bcb-458f-8029-28d26f29a977"],
Cell[CellGroupData[{
Cell[5127, 134, 158, 3, 64, "Section", "ExpressionUUID" -> \
"33f420c8-cadb-4e56-8eb1-75cd695b7bd7"],
Cell[5288, 139, 5001, 108, 369, "Input", "ExpressionUUID" -> \
"79572421-6cc1-47fc-a4c4-dbf87c680188"],
Cell[10292, 249, 152, 3, 32, "Input", "ExpressionUUID" -> \
"f5bd42dc-7337-4d94-835e-49a7bfda0675"],
Cell[CellGroupData[{
Cell[10469, 256, 160, 3, 44, "Subsection", "ExpressionUUID" -> \
"ef4b6e22-a689-49f3-8af3-745ee9195e3f"],
Cell[10632, 261, 7572, 198, 219, "Input", "ExpressionUUID" -> \
"7d670f2f-7076-41df-9c71-f98a61ea2c06"],
Cell[18207, 461, 247, 5, 32, "Input", "ExpressionUUID" -> \
"6eb26d12-3d41-401b-a3f3-bee0e3c41a19"],
Cell[18457, 468, 160, 3, 32, "Input", "ExpressionUUID" -> \
"1ae13ed2-1047-4963-bfdd-e705f13d1f2d"],
Cell[18620, 473, 350, 10, 32, "Input", "ExpressionUUID" -> \
"684897d5-1cb0-49d0-9a0c-050f5985bff5"]
}, Closed]],
Cell[CellGroupData[{
Cell[19007, 488, 230, 4, 36, "Subsection", "ExpressionUUID" -> \
"70c182e5-82a8-4685-bcd3-941839c47cd1"],
Cell[19240, 494, 2311, 59, 77, "Input", "ExpressionUUID" -> \
"dc296ff9-869e-4444-a73e-3517af6d9fe9"],
Cell[21554, 555, 6143, 168, 196, "Input", "ExpressionUUID" -> \
"fd7211c9-860b-4755-ad10-ec10a9448b2a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27746, 729, 160, 3, 64, "Section", "ExpressionUUID" -> \
"e100835a-469e-40d2-acb8-6fa82b533be6"],
Cell[27909, 734, 3598, 83, 390, "Input", "ExpressionUUID" -> \
"3f30506d-4a78-433d-8f05-07d67077c537"],
Cell[CellGroupData[{
Cell[31532, 821, 167, 3, 44, "Subsection", "ExpressionUUID" -> \
"de0c7939-fe1b-41a7-b3c5-61da829a1e10"],
Cell[31702, 826, 2543, 75, 77, "Input", "ExpressionUUID" -> \
"625aae0a-c1a9-4367-b8a4-48ff31767eb1"],
Cell[34248, 903, 10238, 258, 240, "Input", "ExpressionUUID" -> \
"a017f664-8f29-4e36-b50f-0ef50c7dac9e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44523, 1166, 167, 3, 44, "Subsection", "ExpressionUUID" -> \
"f554501f-4f4b-4ed2-bd60-4ca43aba4c49"],
Cell[44693, 1171, 704, 19, 58, "Input", "ExpressionUUID" -> \
"fc73fa1b-5a80-45bd-bc43-f8822a86254b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

